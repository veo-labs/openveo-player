/* openveo-player v2.1.2 */
"use strict";!function(a){var b=a.module("ov.player",["ngCookies"]);if("undefined"==typeof ovPlayerDirectory||"string"!=typeof ovPlayerDirectory)throw new Error("ovPlayerDirectory global variable must be defined and set to the root path of the openVeo player");b.constant("i18nTranslations",{en:{VIDEO_TAB_TITLE:"Video",INDEX_TAB_TITLE:"Index",CHAPTERS_TAB_TITLE:"Chapters",LOADING:"Loading...",MEDIA_ERR_NO_SOURCE:"A network error caused the video download to fail part-way.",MEDIA_ERR_NETWORK:"A network error caused the video download to fail part-way.",MEDIA_ERR_DECODE:"The video playback was aborted due to a corruption problem or because the video used features your browser did not support.",MEDIA_ERR_SRC_NOT_SUPPORTED:"The video could not be loaded, either because the server or network failed or because the format is not supported.",MEDIA_ERR_PERMISSION:"Video not available or private.",MEDIA_ERR_DEFAULT:"An unknown error occurred."},fr:{VIDEO_TAB_TITLE:"Vidéo",INDEX_TAB_TITLE:"Index",CHAPTERS_TAB_TITLE:"Chapitres",LOADING:"Chargement...",MEDIA_ERR_NO_SOURCE:"Une erreur réseau à causé l'échec du téléchargement de la vidéo.",MEDIA_ERR_NETWORK:"Une erreur réseau à causé l'échec du téléchargement de la vidéo.",MEDIA_ERR_DECODE:"La lecture de la vidéo a été abandonnée en raison d' un problème de corruption ou parce que la vidéo utilise des fonctionnalités que votre navigateur ne supporte pas.",MEDIA_ERR_SRC_NOT_SUPPORTED:"La vidéo ne peut être chargée , soit parce que le serveur ou le réseau à échoué ou parce que le format ne sont pas supportées.",MEDIA_ERR_PERMISSION:"Vidéo indisponible ou privée.",MEDIA_ERR_DEFAULT:"Une erreur inconnue est survenue."}}),b.constant("ovPlayerErrors",{MEDIA_ERR_NO_SOURCE:0,MEDIA_ERR_ABORTED:1,MEDIA_ERR_NETWORK:2,MEDIA_ERR_DECODE:3,MEDIA_ERR_SRC_NOT_SUPPORTED:4,MEDIA_ERR_PERMISSION:5,MEDIA_ERR_UNKNOWN:6})}(angular),function(a){function b(a){return{require:["^ovPlayer","^ovTabs"],restrict:"E",templateUrl:ovPlayerDirectory+"templates/chapters.html",scope:!0,link:a}}a.factory("ovChaptersLink",function(){return function(a,b,c,d){a.goToTimecode=function(b){var c=d[0],e=d[1];b<=a.duration&&c.setTime(b),e.selectTabs("media")}}}),a.directive("ovChapters",b),b.$inject=["ovChaptersLink"]}(angular.module("ov.player")),function(a){function b(a){return{require:["^ovPlayer","^ovTabs"],restrict:"E",templateUrl:ovPlayerDirectory+"templates/index.html",scope:!0,link:a}}a.factory("ovIndexLink",function(){return function(a,b,c,d){a.timecodes.length&&(a.imagePreview=a.timecodes[0].image.large),a.setImagePreview=function(b){a.imagePreview=a.timecodesByTime[b].image.large},a.goToTimecode=function(b){var c=d[0],e=d[1];b<=a.duration&&c.setTime(b),e.selectTabs("media")}}}),a.directive("ovIndex",b),b.$inject=["ovIndexLink"]}(angular.module("ov.player")),function(a){function b(){function a(){}return a.prototype.init=function(a,b,c){if(!a||!b)throw new Error("A player JQLite Element and a media object are expected as Player arguments");this.jPlayerElement=a,this.media=b,this.selectedMediaIndex=c||0,this.playerId="player_"+this.media.mediaId[this.selectedMediaIndex]},a.prototype.setSelectedMediaIndex=function(a){this.selectedMediaIndex=a},a.prototype.getSelectedMediaIndex=function(){return this.selectedMediaIndex},a.prototype.getMediaId=function(){return this.media.mediaId},a.prototype.getId=function(){return this.playerId},a.prototype.getMediaSources=function(a){throw new Error("getMediaUrl method not implemented for this player")},a.prototype.getMediaMIME=function(a){return a&&a.mimeType?a.mimeType:"video/mp4"},a.prototype.getAvailableDefinitions=function(){throw new Error("getAvailableDefinitions method not implemented for this player")},a.prototype.getMediaThumbnail=function(){throw new Error("getMediaThumbnail method not implemented for this player")},a.prototype.initialize=function(){throw new Error("initialize method not implemented for this player")},a.prototype.load=function(){throw new Error("load method not implemented for this player")},a.prototype.isPaused=function(){throw new Error("isPaused method not implemented for this player")},a.prototype.playPause=function(){throw new Error("play method not implemented for this player")},a.prototype.setVolume=function(){throw new Error("setVolume method not implemented for this player")},a.prototype.setTime=function(){throw new Error("setTime method not implemented for this player")},a.prototype.getPlayerType=function(){throw new Error("getPlayerType method not implemented for this player")},a.prototype.destroy=function(){throw new Error("destroy method not implemented for this player")},a}a.factory("OvPlayer",b)}(angular.module("ov.player")),function(a,b){function c(b,c,e,f,g,h,i,j,k){return{restrict:"E",templateUrl:ovPlayerDirectory+"templates/player.html",scope:{ovData:"=",ovFullscreenIcon:"=?",ovVolumeIcon:"=?",ovModeIcon:"=?",ovSettingsIcon:"=?",ovMediaSourcesIcon:"=?",ovTime:"=?",ovFullViewport:"=?",ovLanguage:"@?",ovPlayerType:"@?",ovAutoPlay:"@?",ovRememberPosition:"@?"},controller:["$scope","$element",function(e,l){function m(){return L.requestFullScreen||L.mozRequestFullScreen||L.webkitRequestFullScreen||L.msRequestFullscreen}function n(){return 1==("ontouchstart"in window||window.DocumentTouch&&J instanceof DocumentTouch)}function o(a){g(function(){var b=e.$root.$$phase;"$apply"===b||"$digest"===b?a():e.$apply(a)},1)}function p(a){if(e.timecodes.length){if(a<e.timecodes[0].timecode)return null;for(var b=0;b<e.timecodes.length;b++)if(a>=e.timecodes[b].timecode&&e.timecodes[b+1]&&a<e.timecodes[b+1].timecode)return e.timecodes[b].timecode;return e.timecodes[e.timecodes.length-1].timecode}return 0}function q(a){o(function(){e.volumePreview=Math.round((O.bottom-a.pageY)/P*100)})}function r(){c.off("mousemove",q),a.element(N).off("mouseout",r),o(function(){e.volumePreview=0})}function s(a){var b=p((a.pageX-Q.left)/R*e.duration+S.getRealCutStart());o(function(){null!==b&&e.timecodesByTime[b]?e.timePreview=e.timecodesByTime[b].image.large:e.timePreview=null,e.timePreviewPosition=(a.pageX-Q.left)/R*100})}function t(){c.off("mousemove",s),a.element(M).off("mouseout",t),o(function(){e.timePreviewPosition=0,e.timePreviewOpened=!1})}function u(){e.displayIndexTab=!1,e.ovModeIcon=!1,e.selectedMode=d[0]}function v(){e.displayIndexTab=!0,e.ovModeIcon=!0,e.selectedMode=d[1]}function w(){e.displayChapterTab=!1}function x(){e.displayChapterTab=!0}function y(){e.ovData.mediaId&&!Array.isArray(e.ovData.mediaId)&&(e.ovData.mediaId=[e.ovData.mediaId]),e.ovData.sources&&!Array.isArray(e.ovData.sources)&&(e.ovData.sources=[e.ovData.sources])}function z(){e.chapters=S.getMediaChapters()||[]}function A(){if(e.timecodes=S.getMediaTimecodes()||[],e.timecodesByTime=S.getMediaTimecodesByTime()||{},e.timecodes.length){var a=p(e.time);e.timePreview=null!==a?e.timecodesByTime[a].image.large:null,e.presentation=null!==a?e.timecodesByTime[a].image.large:null,v()}else u()}function B(){if(e.data.mediaId&&e.data.mediaId.length){var a=e.ovPlayerType||e.data.type||"html";switch(e.mediaTemplate=ovPlayerDirectory+"templates/"+a+".html",e.data.language=e.ovLanguage,a.toLowerCase()){case"youtube":var c=b.get("OvYoutubePlayer");e.player=new c(l,e.data);break;case"vimeo":var d=b.get("OvVimeoPlayer");e.player=new d(l,e.data);break;case"html":var f=b.get("OvHTMLPlayer");e.player=new f(l,e.data);break;default:throw new Error("Player "+a+" is not supported")}}}function C(){e.player&&("vimeo"!=e.player.getPlayerType()&&e.player.getAvailableDefinitions()||(e.ovSettingsIcon=!1),n()&&(e.ovVolumeIcon=!1),e.ovFullViewport&&!m()&&(e.fullscreenButton="reduce",I=!0),i.setLanguage(e.ovLanguage))}function D(){if(y(),e.data=a.copy(e.ovData)||{},S.setMedia(e.data),U){var b=j.getObject("videoStopped_"+e.data.mediaId);b&&(e.seenPercent=b.percent,e.time=b.time,H=e.time)}B(),e.player&&(e.isCut=e.data.cut&&e.data.cut.length,e.timecodes=[],e.timecodesByTime={},e.chapters=[],e.presentation=null,e.playerId=e.player.getId(),e.timePreviewOpened=!1,e.volumeOpened=!1,e.modesOpened=!1,e.definitionOpened=!1,e.selectMediaOpened=!1,e.modes=a.copy(d),e.selectedMode=d[1],e.playPauseButton="play",e.fullscreenButton="enlarge",e.volumePreview=0,e.volume=100,e.loadedStart=0,e.loadedPercent=0,e.seenPercent=0,e.time=0,e.duration=0,e.timePreviewPosition=0,e.displayIndexTab=!1,e.displayChapterTab=!1,e.mediaThumbnail=e.player.getMediaThumbnail(),e.mediaDefinitions=e.player.getAvailableDefinitions(),e.selectedDefinition=e.mediaDefinitions&&e.mediaDefinitions[e.mediaDefinitions.length-1]||null,e.mediaSources=e.player.getMediaSources(e.selectedDefinition),e.loading=!0,e.initializing=!0,e.error=null,u(),w(),C())}function E(){F&&g.cancel(F),(e.modesOpened||e.definitionOpened||e.volumeOpened||e.selectMediaOpened)&&(F=g(function(){e.modesOpened=e.definitionOpened=e.volumeOpened=e.selectMediaOpened=!1},3e3))}var F,G=this,H=0,I=!1,J=c[0],K=l[0],L=l.children()[0],M=K.getElementsByClassName("ov-time-ghost")[0],N=K.getElementsByClassName("ov-volume-ghost")[0],O=N.getBoundingClientRect(),P=O.bottom-O.top,Q=M.getBoundingClientRect(),R=Q.right-Q.left,S=new h;e.player=null;var T=m();e.ovFullscreenIcon="undefined"==typeof e.ovFullscreenIcon?!0:e.ovFullscreenIcon,e.fullscreenIcon=T&&e.ovFullscreenIcon,e.ovVolumeIcon="undefined"==typeof e.ovVolumeIcon?!0:e.ovVolumeIcon,e.ovModeIcon="undefined"==typeof e.ovModeIcon?!0:e.ovModeIcon,e.ovMediaSourcesIcon="undefined"==typeof e.ovMediaSourcesIcon?!1:e.ovMediaSourcesIcon,e.ovSettingsIcon="undefined"==typeof e.ovSettingsIcon?!0:e.ovSettingsIcon,e.ovTime="undefined"==typeof e.ovTime?!0:e.ovTime,e.ovFullViewport="undefined"==typeof e.ovFullViewport?!1:e.ovFullViewport;var U="undefined"==typeof e.ovRememberPosition?!1:JSON.parse(e.ovRememberPosition);e.ovLanguage="undefined"==typeof e.ovLanguage?"en":e.ovLanguage;var V="undefined"==typeof e.ovAutoPlay?!1:JSON.parse(e.ovAutoPlay);D(),e.toggleModes=function(){e.volumeOpened=!1,e.definitionOpened=!1,e.selectMediaOpened=!1,e.modesOpened=!e.modesOpened,E()},e.toggleVolume=function(){e.modesOpened=!1,e.definitionOpened=!1,e.selectMediaOpened=!1,e.volumeOpened=!e.volumeOpened,E()},e.toggleDefinition=function(){e.volumeOpened=!1,e.modesOpened=!1,e.selectMediaOpened=!1,e.definitionOpened=!e.definitionOpened,E()},e.toggleMedia=function(){e.volumeOpened=!1,e.modesOpened=!1,e.definitionOpened=!1,e.selectMediaOpened=!e.selectMediaOpened,E()},e.toggleFullscreen=function(){L.requestFullScreen||L.mozRequestFullScreen||L.webkitRequestFullScreen||L.msRequestFullscreen?"undefined"!==J.fullScreenElement&&null===J.fullScreenElement||"undefined"!==J.msFullscreenElement&&null===J.msFullscreenElement||"undefined"!==J.mozFullScreen&&J.mozFullScreen===!1||"undefined"!==J.webkitFullscreenElement&&null===J.webkitFullscreenElement?(L.requestFullScreen?L.requestFullScreen():L.mozRequestFullScreen?L.mozRequestFullScreen():L.webkitRequestFullScreen?L.webkitRequestFullScreen():L.msRequestFullscreen&&L.msRequestFullscreen(),e.fullscreenButton="reduce"):(J.exitFullscreen?J.exitFullscreen():J.mozCancelFullScreen?J.mozCancelFullScreen():J.webkitExitFullscreen?J.webkitExitFullscreen():J.msExitFullscreen&&J.msExitFullscreen(),e.fullscreenButton="enlarge"):(I=e.ovFullViewport=!I,e.fullscreenButton=I?"reduce":"enlarge")},e.$on("$includeContentLoaded",function(){g(function(){e.player.initialize()},1)}),e.$on("$destroy",function(){e.player&&e.player.destroy()}),e.$watch("ovData",function(){y();var b=!1;if(e.player)for(var c=e.player.getMediaId(),d=0;d<e.ovData.mediaId.length&&!b;d++)b=e.ovData.mediaId[d]!=c[d];e.data=a.copy(e.ovData)||{},!e.data.mediaId||e.player&&!b||(e.player&&e.player.destroy(),D())}),e.$watch("ovModeIcon",C),e.$watch("ovVolumeIcon",C),e.$watch("ovMediaSourcesIcon",C),e.$watch("ovSettingsIcon",C),e.$watch("ovFullViewport",C),e.setVolume=function(a){var b=Math.min(Math.round((O.bottom-a.pageY)/P*100),100);G.setVolume(b)},e.setTime=function(a){Q=M.getBoundingClientRect(),R=Q.right-Q.left,G.setTime((a.pageX-Q.left)/R*e.duration)},this.selectMode=e.selectMode=function(a){e.selectedMode=a},this.playPause=e.playPause=function(){e.loading||e.error||e.player.playPause()},this.setVolume=function(a){e.volume=a,e.player.setVolume(e.volume)},this.setTime=function(a){e.player.setTime(S.getRealTime(a))},this.setDefinition=e.setDefinition=function(a){a&&(a.link!==e.selectedDefinition.link||"youtube"==e.player.getPlayerType()&&a!==e.selectedDefinition)&&(H=e.time,V=!e.player.isPaused(),e.selectedDefinition=a,e.mediaSources=e.player.getMediaSources(e.selectedDefinition),e.loading=!0,e.initializing=!0,o(function(){e.player.load(e.selectedDefinition)}))},this.selectMediaSource=e.selectMediaSource=function(a){a!=e.player.getSelectedMediaIndex()&&(H=e.time,V=!e.player.isPaused(),e.player.setSelectedMediaIndex(a),e.mediaDefinitions=e.player.getAvailableDefinitions(),e.selectedDefinition=e.mediaDefinitions&&e.mediaDefinitions[e.mediaDefinitions.length-1]||null,e.mediaSources=e.player.getMediaSources(e.selectedDefinition),e.loading=!0,e.initializing=!0,o(function(){e.player.load()}))},a.element(N).on("mouseover",function(){O=N.getBoundingClientRect(),P=O.bottom-O.top,c.on("mousemove",q),a.element(N).on("mouseout",r)}),a.element(M).on("mouseover",function(b){Q=M.getBoundingClientRect(),R=Q.right-Q.left,e.timecodes&&e.timecodes.length&&(s(b),c.on("mousemove",s),a.element(M).on("mouseout",t),o(function(){e.timePreviewOpened=!0}))}),l.on("ovReady",function(a){return a.stopImmediatePropagation(),o(function(){e.player.setVolume(e.volume),e.error=null,e.loading=!1,e.initializing=!1,G.setTime(H),l.triggerHandler("ready"),V&&G.playPause()}),!1}),l.on("ovWaiting",function(a){return a.stopImmediatePropagation(),o(function(){e.loading=!0,l.triggerHandler("waiting")}),!1}),l.on("ovPlaying",function(a){return a.stopImmediatePropagation(),o(function(){e.loading=!1,e.playPauseButton="pause",l.triggerHandler("playing")}),!1}),l.on("ovDurationChange",function(a,b){return a.stopImmediatePropagation(),o(function(){S.setRealMediaDuration(b),e.startCutTime=S.getRealCutStart(),e.duration=S.getCutDuration(),A(),z(),G.setTime(H),S.processChaptersTime(e.chapters),e.chapters.length?x():w(),l.triggerHandler("durationChange",e.duration)}),!1}),l.on("ovPlay",function(a){return a.stopImmediatePropagation(),o(function(){e.mediaDefinitions=e.mediaDefinitions||e.player.getAvailableDefinitions(),e.selectedDefinition=e.selectedDefinition||e.mediaDefinitions&&e.mediaDefinitions[e.mediaDefinitions.length-1]||null,e.ovSettingsIcon=!0,C(),e.loading=!1,e.playPauseButton="pause",l.triggerHandler("play")}),!1}),l.on("ovPause",function(a){return a.stopImmediatePropagation(),o(function(){e.playPauseButton="play",l.triggerHandler("pause")}),!1}),l.on("ovLoadProgress",function(a,b){return a.stopImmediatePropagation(),o(function(){e.loadedStart=S.getCutPercent(b.loadedStart),e.loadedPercent=S.getCutDurationPercent(b.loadedPercent),l.triggerHandler("loadProgress",{loadedStart:e.loadedStart,loadedPercent:e.loadedPercent})}),!1}),l.on("ovPlayProgress",function(a,b){if(a.stopImmediatePropagation(),!e.initializing){e.loading=!1;var c=p(b.time),d=function(){e.time=S.getCutTime(b.time),e.seenPercent=S.getCutPercent(b.percent),e.presentation=null!==c&&e.timecodesByTime[c]?e.timecodesByTime[c].image.large:null;var a={time:e.time,percent:e.seenPercent};l.triggerHandler("playProgress",a);var d=new Date;d.setDate(d.getDate()+1),U&&j.putObject("videoStopped_"+e.data.mediaId,a,{expires:d})};return e.duration&&S.getCutTime(b.time)>S.getCutDuration()?(e.player.setTime(S.getRealTime(0)),U&&j.remove("videoStopped_"+e.data.mediaId),H=0,e.player.playPause()):o(d),!1}}),l.on("ovEnd",function(a){return a.stopImmediatePropagation(),o(function(){U&&j.remove("videoStopped_"+e.data.mediaId),e.time=e.seenPercent=0,H=0,e.playPauseButton="play";var a=p(e.time);null!==a&&e.timecodes.length&&(e.presentation=e.timecodesByTime[a]?e.timecodesByTime[a].image.large:null),e.isCut&&e.player.setTime(S.getRealTime(0)),l.triggerHandler("end")}),!1}),l.on("ovError",function(a,b){o(function(){switch(e.loading=!1,e.initializing=!1,b){case k.MEDIA_ERR_NO_SOURCE:e.error=f("ovTranslate")("MEDIA_NO_SOURCE");break;case k.MEDIA_ERR_NETWORK:e.error=f("ovTranslate")("MEDIA_ERR_NETWORK");break;case k.MEDIA_ERR_DECODE:e.error=f("ovTranslate")("MEDIA_ERR_DECODE");break;case k.MEDIA_ERR_SRC_NOT_SUPPORTED:e.error=f("ovTranslate")("MEDIA_ERR_SRC_NOT_SUPPORTED");break;case k.MEDIA_ERR_PERMISSION:e.error=f("ovTranslate")("MEDIA_ERR_PERMISSION");break;default:e.error=f("ovTranslate")("MEDIA_ERR_DEFAULT")}l.triggerHandler("error",{code:b,message:e.error})})})}]}}var d=["media","both","both-presentation","presentation"];b.directive("ovPlayer",c),c.$inject=["$injector","$document","$sce","$filter","$timeout","PlayerService","i18nPlayerService","$cookies","ovPlayerErrors"]}(angular,angular.module("ov.player")),function(a){function b(){this.media=null,this.cutStart=0,this.cutEnd=null,this.realMediaDuration=null,this.isCut=!1}b.prototype.getRealCutStart=function(){return this.realMediaDuration&&this.cutStart?this.realMediaDuration*this.cutStart:0},b.prototype.getRealCutEnd=function(){return this.realMediaDuration?this.cutEnd?this.realMediaDuration*this.cutEnd:this.realMediaDuration:0},b.prototype.getRealTime=function(a){return a+this.getRealCutStart()},b.prototype.getCutTime=function(a){return Math.max(a-this.getRealCutStart(),0)},b.prototype.setMedia=function(a){if(this.media=a,this.isCut=this.media.cut&&this.media.cut.length,this.isCut){for(var b=0;b<this.media.cut.length;b++)"begin"===this.media.cut[b].type?this.cutStart=Math.max(this.media.cut[b].value,0):"end"===this.media.cut[b].type&&(this.cutEnd=Math.min(this.media.cut[b].value,1));this.cutStart===this.cutEnd&&(this.cutStart=0,this.cutEnd=null)}else this.cutStart=0,this.cutEnd=null},b.prototype.getMediaTimecodes=function(){if(this.isCut&&this.realMediaDuration&&this.media.timecodes){for(var a=[],b=this.getRealCutStart(),c=this.getRealCutEnd(),d=0;d<this.media.timecodes.length;d++){var e=this.media.timecodes[d].timecode;e>=b&&c>=e&&a.push(this.media.timecodes[d])}return a}return this.media.timecodes},b.prototype.getMediaTimecodesByTime=function(){var a={},b=this.getMediaTimecodes();if(b)for(var c=0;c<b.length;c++){var d=b[c];a[d.timecode]={image:{small:d.image.small,large:d.image.large}}}return a},b.prototype.getMediaChapters=function(){if(this.isCut&&this.realMediaDuration&&this.media.chapters){for(var a=[],b=this.getRealCutStart(),c=this.getRealCutEnd(),d=0;d<this.media.chapters.length;d++){var e=this.realMediaDuration*this.media.chapters[d].value;e>b&&c>e&&a.push(this.media.chapters[d])}return angular.copy(a)}return angular.copy(this.media.chapters)},b.prototype.processChaptersTime=function(a){for(var b=0;b<a.length;b++)a[b].value=a[b].value*this.realMediaDuration-Math.floor(this.cutStart*this.realMediaDuration)},b.prototype.getCutDuration=function(){if(this.realMediaDuration){var a=this.getRealCutEnd(),b=this.getRealCutStart();return a-b}return 0},b.prototype.getCutPercent=function(a){if(this.realMediaDuration){var b=this.realMediaDuration*(a/100);return Math.min(Math.max((b-this.getRealCutStart())/this.getCutDuration()*100,0),100)}return a},b.prototype.getCutDurationPercent=function(a){if(this.realMediaDuration){var b=this.realMediaDuration*(a/100);return Math.min(Math.max(b/this.getCutDuration()*100,0),100)}return a},b.prototype.setRealMediaDuration=function(a){this.realMediaDuration=a},a.value("PlayerService",b)}(angular.module("ov.player")),function(a){function b(){return{restrict:"E",templateUrl:ovPlayerDirectory+"templates/tabs.html",scope:{},transclude:!0,controller:["$scope","$filter",function(a,b){a.views=[],a.select=function(b){angular.forEach(a.views,function(a){a.selected=!1}),b.selected=!0},this.selectTabs=function(c){var d=b("filter")(a.views,{viewId:c},!0);0!=d.length&&a.select(d[0])},this.addView=function(b){a.views.length||a.select(b),a.views.push(b)}}]}}a.directive("ovTabs",b)}(angular.module("ov.player")),function(a){function b(){return function(a){if(0>a||isNaN(a))return"";a=parseInt(a);var b=parseInt(a/1e3%60),c=parseInt(a/6e4%60),d=parseInt(a/36e5%24);return d=10>d?"0"+d:d,c=10>c?"0"+c:c,b=10>b?"0"+b:b,("00"!==d?d+":":"")+c+":"+b}}a.filter("millisecondsToTime",b)}(angular.module("ov.player")),function(a){function b(a){return{restrict:"E",require:"^ovTabs",transclude:!0,templateUrl:ovPlayerDirectory+"templates/view.html",scope:{title:"@",view:"@",viewId:"@"},link:a}}a.factory("ovViewLink",function(){return function(a,b,c,d){d.addView(a)}}),a.directive("ovView",b),b.$inject=["ovViewLink"]}(angular.module("ov.player")),function(a){function b(a){return function(b){return a.translate(b)}}a.filter("ovTranslate",b),b.$inject=["i18nPlayerService"]}(angular.module("ov.player")),function(a,b){function c(a){function b(b){return Object.keys(a).indexOf(b)>=0}function c(a){f=b(a)?a:"en"}function d(){return f}function e(b){var c=a[f]&&a[f][b]||b;return c===b&&(c=a.en[b]||b),c}var f=navigator.language||navigator.browserLanguage;return{translate:e,isLanguageSupported:b,setLanguage:c,getLanguage:d}}b.service("i18nPlayerService",c),c.$inject=["i18nTranslations"]}(angular,angular.module("ov.player")),function(a,b){function c(b,c,d,e){function f(a){switch(a.type){case"progress":var b=this.player.buffered();if(b.length>=1){var c=this.player.currentTime()/this.player.duration();this.jPlayerElement.triggerHandler("ovLoadProgress",{loadedStart:100*Math.max(0,Math.min(c,1)),loadedPercent:100*this.player.bufferedPercent()})}break;case"durationchange":var d=this.player.duration()||this.media.metadata&&this.media.metadata.duration;this.jPlayerElement.triggerHandler("ovDurationChange",1e3*d);break;case"loadeddata":case"loadedmetadata":this.loaded=!0,this.jPlayerElement.triggerHandler("ovReady");break;case"play":this.jPlayerElement.triggerHandler("ovPlay");break;case"pause":this.jPlayerElement.triggerHandler("ovPause");break;case"ended":this.jPlayerElement.triggerHandler("ovEnd");break;case"waiting":this.jPlayerElement.triggerHandler("ovWaiting");break;case"playing":this.jPlayerElement.triggerHandler("ovPlaying");break;case"timeupdate":var e=this.player.currentTime(),f=e/this.player.duration()*100;this.jPlayerElement.triggerHandler("ovPlayProgress",{time:1e3*e,percent:f});break;case"error":this.player.networkState()==this.player.NETWORK_NO_SOURCE&&(a.target.error={code:"NO_SOURCE",MEDIA_NO_SOURCE:"NO_SOURCE"}),this.jPlayerElement.triggerHandler("error",a.target.error&&a.target.error.code)}}function g(a,c){b.prototype.init.call(this,a,c);for(var d=0;d<this.media.sources.length;d++)this.media.sources[d].files&&this.media.sources[d].files.sort(function(a,b){return a.height<b.height?1:-1})}var h=["loadeddata","progress","playing","waiting","ended","durationchange","loadedmetadata","timeupdate","play","pause","error"];return g.prototype=new b,g.prototype.constructor=g,g.prototype.getMediaSources=function(a){return a?[{src:a.link,type:"video/mp4"}]:this.media.sources[this.selectedMediaIndex].adaptive.map(function(a){var b={};return b.src=a.link,b.type=a.mimeType,b})},g.prototype.getMediaThumbnail=function(){return this.media.thumbnail},g.prototype.initialize=function(){var b=this;this.loaded=!1,this.player=videojs(this.playerId,{techOrder:["html5","flash"],autoplay:!1,preload:"auto"}),this.player.ready(function(){b.handlePlayerEventsFn=a.bind(b,f);for(var c=0;c<h.length;c++)this.on(h[c],b.handlePlayerEventsFn);this.error_||b.load()})},g.prototype.load=function(a){var b=this.getAvailableDefinitions(),c=a||b&&b[b.length-1]||null,d=this.getMediaSources(c);this.player.src(d),this.player.load()},g.prototype.isPaused=function(){return this.player.paused()},g.prototype.playPause=function(){this.player.paused()||this.player.ended()?this.player.play():this.player.pause()},g.prototype.setVolume=function(a){this.player.volume(a/100)},g.prototype.setTime=function(a){a=parseInt(a)||.1,this.player.currentTime(a/1e3)},g.prototype.getPlayerType=function(){return"html"},g.prototype.getAvailableDefinitions=function(){var a=this.media.sources[this.selectedMediaIndex];return a.adaptive&&0!=a.adaptive.length?null:a.files},g.prototype.destroy=function(){this.handlePlayerEventsFn=a.bind(this,f);for(var b=a.element(this.player),c=0;c<h.length;c++)b.off(h[c],this.handlePlayerEventsFn);this.loaded=!1,this.player.dispose(),this.player=null},g}b.factory("OvHTMLPlayer",c),c.$inject=["OvPlayer","$window","$document","$sce"]}(angular,angular.module("ov.player")),function(a,b){function c(b,c,d,e){function f(a,b){if(this.loaded){var c={method:a};return b&&(c.value=b),this.player.contentWindow.postMessage(JSON.stringify(c),this.postMessageTargetOrigin)}return null}function g(){this.postMessageTargetOrigin="https://player.vimeo.com/video/"+this.media.mediaId[this.selectedMediaIndex],this.player=d[0].getElementById(this.playerId),this.loaded=!0,this.playing=0,f.call(this,"addEventListener","loadProgress"),f.call(this,"addEventListener","playProgress"),f.call(this,"addEventListener","play"),f.call(this,"addEventListener","pause"),f.call(this,"addEventListener","finish")}function h(a,b){if(b=a.data?JSON.parse(a.data):b,b.player_id===this.playerId){switch(b.event){case"ready":g.call(this),f.call(this,"getDuration"),this.jPlayerElement.triggerHandler("ovReady");break;case"loadProgress":this.jPlayerElement.triggerHandler("ovLoadProgress",{loadedStart:0,loadedPercent:100*b.data.percent});break;case"playProgress":b.data.percent<=1&&this.jPlayerElement.triggerHandler("ovPlayProgress",{time:1e3*b.data.seconds,percent:100*b.data.percent});break;case"play":this.playing=1,this.jPlayerElement.triggerHandler("ovPlay");break;case"pause":this.playing=0,this.jPlayerElement.triggerHandler("ovPause");break;case"finish":this.playing=0,this.jPlayerElement.triggerHandler("ovEnd")}switch(b.method){case"getDuration":this.duration=b.value,this.jPlayerElement.triggerHandler("ovDurationChange",1e3*this.duration);break;default:return}}}function i(){this.loaded=!1,this.handlePlayerEventsFn=a.bind(this,h),a.element(c).on("message",this.handlePlayerEventsFn)}function j(a,c){b.prototype.init.call(this,a,c),i.call(this)}return j.prototype=new b,j.prototype.constructor=j,j.prototype.getMediaSources=function(a){return a&&a.link?e.trustAsResourceUrl(a.link):e.trustAsResourceUrl("//player.vimeo.com/video/"+this.media.mediaId[this.selectedMediaIndex]+"?api=1&player_id="+this.playerId)},j.prototype.getMediaThumbnail=function(){return null},j.prototype.initialize=function(){},j.prototype.load=function(){},j.prototype.isPaused=function(){return!this.playing},j.prototype.playPause=function(){f.call(this,this.playing?"pause":"play")},j.prototype.setVolume=function(a){f.call(this,"setVolume",a/100)},j.prototype.setTime=function(a){a=parseInt(a)||0,f.call(this,"seekTo",a/1e3),this.playing||this.jPlayerElement.triggerHandler("ovPlayProgress",{time:a,percent:a/this.duration*100})},j.prototype.getPlayerType=function(){return"vimeo"},j.prototype.getAvailableDefinitions=function(){return null},j.prototype.destroy=function(){a.element(c).off("message",this.handlePlayerEventsFn),this.loaded=!1,this.playing=0,this.player=null},j}b.factory("OvVimeoPlayer",c),c.$inject=["OvPlayer","$window","$document","$sce"]}(angular,angular.module("ov.player")),function(a,b){function c(b,c,d){function e(a,b){switch(b=a.data?JSON.parse(a.data):b,b.event){case"infoDelivery":void 0!==b.info.currentTime&&this.duration&&this.jPlayerElement.triggerHandler("ovPlayProgress",{time:1e3*b.info.currentTime,percent:b.info.currentTime/this.duration*100}),b.info.videoLoadedFraction&&this.jPlayerElement.triggerHandler("ovLoadProgress",{loadedStart:0,loadedPercent:100*b.info.videoLoadedFraction});break;case"onStateChange":if(b.info!=YT.PlayerState.PLAYING)this.playing=0,this.jPlayerElement.triggerHandler("ovPause"),b.info==YT.PlayerState.ENDED?this.jPlayerElement.triggerHandler("ovEnd"):-1==b.info&&this.jPlayerElement.triggerHandler("ovReady");else{this.playing=1,this.jPlayerElement.triggerHandler("ovPlay"),this.requestPause&&(this.requestPause=!1,this.player.pauseVideo());var c=this.player.getDuration();!this.duration&&c&&(this.duration=c,this.jPlayerElement.triggerHandler("ovDurationChange",1e3*this.duration))}}}function f(){if(this.ressourceLoaded&&this.apiLoaded){var b=this;this.loaded=!1,this.player=new YT.Player(this.playerId,{playerVars:{fs:0,rel:0,autoplay:0,html5:1,theme:"light",modesbranding:1,color:"white",iv_load_policy:3,showinfo:0,controls:0,hl:this.media.language},events:{onReady:function(){b.jPlayerElement.triggerHandler("ovReady"),b.handlePlayerEventsFn=a.bind(b,e),a.element(c).on("message",b.handlePlayerEventsFn);for(var d=a.element(b.player),f=0;f<h.length;f++)d.on(h[f],b.handlePlayerEventsFn);b.loaded=!0,b.playing=0},onError:function(a){switch(a.data){case 100:case 101:case 150:b.jPlayerElement.triggerHandler("ovError",d.MEDIA_ERR_PERMISSION);break;default:b.jPlayerElement.triggerHandler("ovError",d.MEDIA_ERR_UNKNOWN)}}},videoId:this.media.mediaId[this.selectedMediaIndex]})}}function g(a,d){var e=this,g="youtube-iframe-api";b.prototype.init.call(this,a,d),this.requestPause=!1;var h=document.createElement("script");if(h.setAttribute("id",g),h.src="https://www.youtube.com/iframe_api",c.onYouTubeIframeAPIReady=function(){e.apiLoaded=!0,f.call(e)},document.getElementById(g))this.apiLoaded=!0,f.call(e);else{var i=document.getElementsByTagName("script")[0];i.parentNode.insertBefore(h,i)}}var h=["onStateChange","infoDelivery","infoDelivery","onPlaybackQualityChange","loadeddata","progress","playing","ended","timeupdate","error"];return g.prototype=new b,g.prototype.constructor=g,g.prototype.getMediaSources=function(a){return this.player&&(this.player.setPlaybackQuality(a),this.jPlayerElement.triggerHandler("ovReady")),null},g.prototype.getMediaThumbnail=function(){return null},g.prototype.initialize=function(){this.ressourceLoaded=!0,f.call(this)},g.prototype.playPause=function(){this.playing?this.player.pauseVideo():(this.requestPause=!1,this.player.playVideo())},g.prototype.setVolume=function(a){this.player.setVolume(a)},g.prototype.setTime=function(a){var b=this.player.getPlayerState();a=parseInt(a)||0,this.playing||b!==YT.PlayerState.CUED||(this.requestPause=!0),this.player.seekTo(a/1e3,!0),this.playing||this.jPlayerElement.triggerHandler("ovPlayProgress",{time:a,percent:a/this.duration*100})},g.prototype.getPlayerType=function(){return"youtube"},g.prototype.isPaused=function(){return this.player.getPlayerState()!=YT.PlayerState.PAUSED},g.prototype.load=function(a){a||this.player.loadVideoById(this.media.mediaId[this.selectedMediaIndex])},g.prototype.getAvailableDefinitions=function(){var a;return this.player&&(a=this.player.getAvailableQualityLevels()),a},g.prototype.destroy=function(){a.element(c).off("message",this.handlePlayerEventsFn),this.player.destroy(),this.loaded=!1,this.playing=0,this.player=null},g}b.factory("OvYoutubePlayer",c),c.$inject=["OvPlayer","$window","ovPlayerErrors"]}(angular,angular.module("ov.player"));