/* openveo-player v3.0.0 */
"use strict";!function(a){var b=a.module("ov.player",["ngCookies"]);if("undefined"==typeof ovPlayerDirectory||"string"!=typeof ovPlayerDirectory)throw new Error("ovPlayerDirectory global variable must be defined and set to the root path of the openVeo player");b.constant("ovPlayerI18nTranslations",{en:{VIDEO_TAB_TITLE:"Video",INDEX_TAB_TITLE:"Index",CHAPTERS_TAB_TITLE:"Chapters",TAGS_TAB_TITLE:"Tags",LOADING:"Loading...",FILE_DOWNLOAD:"Download",MEDIA_ERR_NO_SOURCE:"A network error caused the video download to fail part-way.",MEDIA_ERR_NETWORK:"A network error caused the video download to fail part-way.",MEDIA_ERR_DECODE:"The video playback was aborted due to a corruption problem or because the video used features your browser did not support.",MEDIA_ERR_SRC_NOT_SUPPORTED:"The video could not be loaded, either because the server or network failed or because the format is not supported.",MEDIA_ERR_PERMISSION:"Video not available or private.",MEDIA_ERR_DEFAULT:"An unknown error occurred."},fr:{VIDEO_TAB_TITLE:"Vidéo",INDEX_TAB_TITLE:"Index",CHAPTERS_TAB_TITLE:"Chapitres",TAGS_TAB_TITLE:"Tags",LOADING:"Chargement...",FILE_DOWNLOAD:"Télécharger",MEDIA_ERR_NO_SOURCE:"Une erreur réseau à causé l'échec du téléchargement de la vidéo.",MEDIA_ERR_NETWORK:"Une erreur réseau à causé l'échec du téléchargement de la vidéo.",MEDIA_ERR_DECODE:"La lecture de la vidéo a été abandonnée en raison d' un problème de corruption ou parce que la vidéo utilise des fonctionnalités que votre navigateur ne supporte pas.",MEDIA_ERR_SRC_NOT_SUPPORTED:"La vidéo ne peut être chargée , soit parce que le serveur ou le réseau à échoué ou parce que le format ne sont pas supportées.",MEDIA_ERR_PERMISSION:"Vidéo indisponible ou privée.",MEDIA_ERR_DEFAULT:"Une erreur inconnue est survenue."}}),b.constant("ovPlayerErrors",{MEDIA_ERR_NO_SOURCE:0,MEDIA_ERR_ABORTED:1,MEDIA_ERR_NETWORK:2,MEDIA_ERR_DECODE:3,MEDIA_ERR_SRC_NOT_SUPPORTED:4,MEDIA_ERR_PERMISSION:5,MEDIA_ERR_UNKNOWN:6})}(angular),function(a){function b(a){return{require:["^ovPlayer","^ovPlayerTabs"],restrict:"E",templateUrl:ovPlayerDirectory+"templates/chapters.html",scope:!0,link:a}}a.factory("ovChaptersLink",["$sce",function(a){return function(b,c,d,e){b.goToTimecode=function(a){var c=e[0],d=e[1];a<=b.duration&&c.setTime(a),d.selectTabs("media")},b.trustedHTML=function(b){return a.trustAsHtml(b)}}}]),a.directive("ovPlayerChapters",b),b.$inject=["ovChaptersLink"]}(angular.module("ov.player")),function(a){function b(a){return function(b){return a.translate(b)}}a.filter("ovPlayerTranslate",b),b.$inject=["ovPlayerI18nService"]}(angular.module("ov.player")),function(a,b){function c(a){function b(b){return Object.keys(a).indexOf(b)>=0}function c(a){f=b(a)?a:"en"}function d(){return f}function e(b){var c=a[f]&&a[f][b]||b;return c===b&&(c=a.en[b]||b),c}var f=navigator.language||navigator.browserLanguage;return{translate:e,isLanguageSupported:b,setLanguage:c,getLanguage:d}}b.service("ovPlayerI18nService",c),c.$inject=["ovPlayerI18nTranslations"]}(angular,angular.module("ov.player")),function(a){function b(a){return{require:["^ovPlayer","^ovPlayerTabs"],restrict:"E",templateUrl:ovPlayerDirectory+"templates/index.html",scope:!0,link:a}}a.factory("ovIndexLink",function(){return function(a,b,c,d){a.timecodes.length&&(a.imagePreview=a.timecodes[0].image.large),a.setImagePreview=function(b){a.imagePreview=a.timecodesByTime[b].image.large},a.goToTimecode=function(b){var c=d[0],e=d[1];b<=a.duration&&c.setTime(b),e.selectTabs("media")}}}),a.directive("ovPlayerIndex",b),b.$inject=["ovIndexLink"]}(angular.module("ov.player")),function(a){function b(){function a(){}return a.prototype.init=function(a,b){if(!a)throw new Error("A player JQLite Element is expected as Player argument");this.jPlayerElement=a,this.selectedSourceIndex=0,this.playerId=b},a.prototype.setMediaSource=function(a){this.selectedSourceIndex=a},a.prototype.getSourceIndex=function(){return this.selectedSourceIndex},a.prototype.getMediaIds=function(){return this.media.mediaId},a.prototype.getId=function(){return this.playerId},a.prototype.setMedia=function(a){if(!a)throw new Error("Player needs a valid media");this.media=a},a.prototype.getSourceUrl=function(){return null},a.prototype.getMediaMIME=function(a){return a&&a.mimeType?a.mimeType:"video/mp4"},a.prototype.getAvailableDefinitions=function(){throw new Error("getAvailableDefinitions method not implemented for this player")},a.prototype.getMediaThumbnail=function(){throw new Error("getMediaThumbnail method not implemented for this player")},a.prototype.initialize=function(){throw new Error("initialize method not implemented for this player")},a.prototype.load=function(){throw new Error("load method not implemented for this player")},a.prototype.isPaused=function(){throw new Error("isPaused method not implemented for this player")},a.prototype.isPlaying=function(){throw new Error("isPlaying method not implemented for this player")},a.prototype.playPause=function(){throw new Error("play method not implemented for this player")},a.prototype.setVolume=function(){throw new Error("setVolume method not implemented for this player")},a.prototype.setTime=function(){throw new Error("setTime method not implemented for this player")},a.prototype.getPlayerType=function(){throw new Error("getPlayerType method not implemented for this player")},a.prototype.destroy=function(){throw new Error("destroy method not implemented for this player")},a.prototype.setDefinition=function(a){throw new Error("setDefinition method not implemented for this player")},a}a.factory("OvPlayer",b)}(angular.module("ov.player")),function(a,b){function c(b,c,e,f,g,h,i,j,k){return{restrict:"E",templateUrl:ovPlayerDirectory+"templates/player.html",scope:{ovData:"=",ovFullscreenIcon:"=?",ovVolumeIcon:"=?",ovModeIcon:"=?",ovSettingsIcon:"=?",ovMediaSourcesIcon:"=?",ovTime:"=?",ovFullViewport:"=?",ovLanguage:"@?",ovPlayerType:"@?",ovAutoPlay:"@?",ovRememberPosition:"@?"},controller:["$scope","$element",function(e,l){function m(){return N.requestFullScreen||N.mozRequestFullScreen||N.webkitRequestFullScreen||N.msRequestFullscreen}function n(){return 1==("ontouchstart"in window||window.DocumentTouch&&L instanceof DocumentTouch)}function o(a){g(function(){var b=e.$root.$$phase;"$apply"===b||"$digest"===b?a():e.$apply(a)},1)}function p(a){if(e.timecodes.length){if(a<e.timecodes[0].timecode)return null;for(var b=0;b<e.timecodes.length;b++)if(a>=e.timecodes[b].timecode&&e.timecodes[b+1]&&a<e.timecodes[b+1].timecode)return e.timecodes[b].timecode;return e.timecodes[e.timecodes.length-1].timecode}return 0}function q(a){o(function(){e.volumePreview=Math.round((Q.bottom-a.pageY)/R*100)})}function r(){c.off("mousemove",q),a.element(P).off("mouseout",r),o(function(){e.volumePreview=0})}function s(a){var b=p((a.pageX-S.left)/T*e.duration+U.getRealCutStart());o(function(){null!==b&&e.timecodesByTime[b]?e.timePreview=e.timecodesByTime[b].image.large:e.timePreview=null,e.timePreviewPosition=(a.pageX-S.left)/T*100})}function t(){c.off("mousemove",s),a.element(O).off("mouseout",t),o(function(){e.timePreviewPosition=0,e.timePreviewOpened=!1})}function u(){e.displayIndexTab=!1,e.selectedMode=d[0]}function v(){e.displayIndexTab=!0,e.selectedMode=d[1]}function w(){e.displayChapterTab=!1}function x(){e.displayChapterTab=!0}function y(){e.displayTagsTab=!1}function z(){e.displayTagsTab=!0}function A(a){a&&(a.mediaId&&!Array.isArray(a.mediaId)&&(a.mediaId=[a.mediaId]),a.sources&&!Array.isArray(a.sources)&&(a.sources=[a.sources]))}function B(){e.chapters=U.getMediaPointsOfInterest("chapters")||[],e.tags=U.getMediaPointsOfInterest("tags")||[]}function C(){if(e.timecodes=U.getMediaTimecodes()||[],e.timecodesByTime=U.getMediaTimecodesByTime()||{},e.timecodes.length){var a=p(e.time);e.timePreview=null!==a?e.timecodesByTime[a].image.large:null,e.presentation=null!==a?e.timecodesByTime[a].image.large:null,v()}else u()}function D(){if(e.data.mediaId&&e.data.mediaId.length){var a=e.ovPlayerType||"html",c="player_"+(new Date).getUTCMilliseconds();switch(e.mediaTemplate=ovPlayerDirectory+"templates/"+a+".html",e.data.language=e.ovLanguage,a.toLowerCase()){case"youtube":var d=b.get("OvPlayerYoutube");e.player=new d(l,e.data,c);break;case"vimeo":var f=b.get("OvPlayerVimeo");e.player=new f(l,e.data,c);break;case"html":var g=b.get("OvPlayerHTML");e.player=new g(l,e.data,c);break;default:throw new Error("Player "+a+" is not supported")}}}function E(){e.player&&(e.settingsIcon=!!e.player.getAvailableDefinitions()&&e.ovSettingsIcon,n()&&(e.ovVolumeIcon=!1),e.fullViewport&&!m()&&(e.fullscreenButton="reduce",K=!0),e.ovFullViewport&&!m()&&(e.fullscreenIcon=!1),e.modeIcon=e.displayIndexTab&&e.ovModeIcon,i.setLanguage(e.ovLanguage))}function F(b){if(e.data=a.copy(e.ovData)||{},A(e.data),U.setMedia(e.data),e.ovRememberPosition){var c=j.getObject("videoStopped_"+e.data.mediaId);c&&(e.seenPercent=c.percent,e.time=c.time,J=e.time)}b?D():e.player&&e.player.setMedia(e.data),e.player&&(e.isCut=e.data.cut&&e.data.cut.length,e.timecodes=[],e.timecodesByTime={},e.chapters=[],e.presentation=null,e.playerId=e.player.getId(),e.timePreviewOpened=!1,e.volumeOpened=!1,e.modesOpened=!1,e.definitionOpened=!1,e.selectMediaOpened=!1,e.modes=a.copy(d),e.selectedMode=d[1],e.playPauseButton="play",e.fullscreenButton="enlarge",e.volumePreview=0,e.volume=100,e.loadedStart=0,e.loadedPercent=0,e.seenPercent=0,e.time=0,e.duration=0,e.timePreviewPosition=0,e.displayIndexTab=!1,e.displayChapterTab=!1,e.displayTagsTab=!1,e.mediaThumbnail=e.player.getMediaThumbnail(),e.mediaDefinitions=e.player.getAvailableDefinitions(),e.selectedDefinition=e.mediaDefinitions&&e.mediaDefinitions[e.mediaDefinitions.length-1]||null,e.sourceUrl=e.player.getSourceUrl(),e.loading=!0,e.initializing=!0,e.error=null,u(),w(),y(),E(),b||(J=0,e.player.load()))}function G(){H&&g.cancel(H),(e.modesOpened||e.definitionOpened||e.volumeOpened||e.selectMediaOpened)&&(H=g(function(){e.modesOpened=e.definitionOpened=e.volumeOpened=e.selectMediaOpened=!1},3e3))}var H,I=this,J=0,K=!1,L=c[0],M=l[0],N=l.children()[0],O=M.getElementsByClassName("ov-time-ghost")[0],P=M.getElementsByClassName("ov-volume-ghost")[0],Q=P.getBoundingClientRect(),R=Q.bottom-Q.top,S=O.getBoundingClientRect(),T=S.right-S.left,U=new h,V=!1;e.player=null;var W=m();e.toggleModes=function(){e.volumeOpened=!1,e.definitionOpened=!1,e.selectMediaOpened=!1,e.modesOpened=!e.modesOpened,G()},e.toggleVolume=function(){e.modesOpened=!1,e.definitionOpened=!1,e.selectMediaOpened=!1,e.volumeOpened=!e.volumeOpened,G()},e.toggleDefinition=function(){e.volumeOpened=!1,e.modesOpened=!1,e.selectMediaOpened=!1,e.definitionOpened=!e.definitionOpened,G()},e.toggleMedia=function(){e.volumeOpened=!1,e.modesOpened=!1,e.definitionOpened=!1,e.selectMediaOpened=!e.selectMediaOpened,G()},e.toggleFullscreen=function(){N.requestFullScreen||N.mozRequestFullScreen||N.webkitRequestFullScreen||N.msRequestFullscreen?"undefined"!==L.fullScreenElement&&null===L.fullScreenElement||"undefined"!==L.msFullscreenElement&&null===L.msFullscreenElement||"undefined"!==L.mozFullScreen&&L.mozFullScreen===!1||"undefined"!==L.webkitFullscreenElement&&null===L.webkitFullscreenElement?(N.requestFullScreen?N.requestFullScreen():N.mozRequestFullScreen?N.mozRequestFullScreen():N.webkitRequestFullScreen?N.webkitRequestFullScreen():N.msRequestFullscreen&&N.msRequestFullscreen(),e.fullscreenButton="reduce"):(L.exitFullscreen?L.exitFullscreen():L.mozCancelFullScreen?L.mozCancelFullScreen():L.webkitExitFullscreen?L.webkitExitFullscreen():L.msExitFullscreen&&L.msExitFullscreen(),e.fullscreenButton="enlarge"):(K=e.fullViewport=!K,e.fullscreenButton=K?"reduce":"enlarge")},e.$on("$includeContentLoaded",function(){g(function(){e.player.initialize()},1)}),e.$on("$destroy",function(){e.player&&e.player.destroy()}),e.$watch("ovData",function(a,b){a&&F(!b||a===b)}),e.$watch("ovFullscreenIcon",function(a,b){e.ovFullscreenIcon=e.fullscreenIcon=W&&("undefined"==typeof a||a),E()}),e.$watch("ovVolumeIcon",function(a,b){e.ovVolumeIcon="undefined"==typeof a||a,E()}),e.$watch("ovModeIcon",function(a,b){e.ovModeIcon=e.modeIcon="undefined"==typeof a||a,E()}),e.$watch("ovSettingsIcon",function(a,b){e.ovSettingsIcon=e.settingsIcon="undefined"==typeof a||a,E()}),e.$watch("ovFullViewport",function(a,b){e.ovFullViewport=e.fullViewport="undefined"!=typeof a&&a,E()}),e.$watch("ovTime",function(a,b){e.ovTime="undefined"==typeof a||a}),e.$watch("ovMediaSourcesIcon",function(a,b){e.ovMediaSourcesIcon="undefined"!=typeof a&&a}),e.$watch("ovRememberPosition",function(a,b){e.ovRememberPosition="undefined"!=typeof a&&JSON.parse(a)}),e.$watch("ovLanguage",function(a,b){e.ovLanguage="undefined"==typeof a?"en":a}),e.$watch("ovAutoPlay",function(a,b){e.ovAutoPlay="undefined"!=typeof a&&JSON.parse(a)}),e.setVolume=function(a){var b=Math.min(Math.round((Q.bottom-a.pageY)/R*100),100);I.setVolume(b)},e.setTime=function(a){S=O.getBoundingClientRect(),T=S.right-S.left,I.setTime((a.pageX-S.left)/T*e.duration)},this.selectMode=e.selectMode=function(a){e.selectedMode=a},this.playPause=e.playPause=function(){e.loading||e.error||e.player.playPause()},this.setVolume=function(a){e.volume=a,e.player.setVolume(e.volume)},this.setTime=function(a){e.player.setTime(U.getRealTime(a))},this.setDefinition=e.setDefinition=function(a){a&&a!==e.selectedDefinition&&(J=e.time,V=!e.player.isPaused(),e.selectedDefinition=a,e.loading=!0,e.initializing=!0,o(function(){e.player.setDefinition(e.selectedDefinition)}))},this.setSource=e.setSource=function(a){a!=e.player.getSourceIndex()&&(J=e.time,V=!e.player.isPaused(),e.player.setMediaSource(a),e.mediaDefinitions=e.player.getAvailableDefinitions(),e.selectedDefinition=e.mediaDefinitions&&e.mediaDefinitions[e.mediaDefinitions.length-1]||null,e.loading=!0,e.initializing=!0,o(function(){e.sourceUrl=e.player.getSourceUrl(),e.player.load()}))},a.element(P).on("mouseover",function(){Q=P.getBoundingClientRect(),R=Q.bottom-Q.top,c.on("mousemove",q),a.element(P).on("mouseout",r)}),a.element(O).on("mouseover",function(b){S=O.getBoundingClientRect(),T=S.right-S.left,e.timecodes&&e.timecodes.length&&(s(b),c.on("mousemove",s),a.element(O).on("mouseout",t),o(function(){e.timePreviewOpened=!0}))}),l.on("ovReady",function(a){return a.stopImmediatePropagation(),o(function(){e.player.setVolume(e.volume),e.error=null,e.loading=!1,e.initializing=!1,I.setTime(J),l.triggerHandler("ready"),!e.ovAutoPlay&&!V||e.player.isPlaying()||(V=!1,I.playPause())}),!1}),l.on("ovWaiting",function(a){return a.stopImmediatePropagation(),o(function(){e.loading=!0,l.triggerHandler("waiting")}),!1}),l.on("ovPlaying",function(a){return a.stopImmediatePropagation(),o(function(){e.loading=!1,e.playPauseButton="pause",l.triggerHandler("playing")}),!1}),l.on("ovDurationChange",function(a,b){return a.stopImmediatePropagation(),o(function(){U.setRealMediaDuration(b),e.startCutTime=U.getRealCutStart(),e.duration=U.getCutDuration(),C(),B(),I.setTime(J),U.processPointsOfInterestTime(e.chapters),U.processPointsOfInterestTime(e.tags),e.chapters.length?x():w(),e.tags.length?z():y(),E(),l.triggerHandler("durationChange",e.duration)}),!1}),l.on("ovPlay",function(a){return a.stopImmediatePropagation(),o(function(){e.mediaDefinitions=e.player.getAvailableDefinitions(),e.selectedDefinition=e.selectedDefinition||e.mediaDefinitions&&e.mediaDefinitions[e.mediaDefinitions.length-1]||null,E(),e.loading=!1,e.playPauseButton="pause",l.triggerHandler("play")}),!1}),l.on("ovPause",function(a){return a.stopImmediatePropagation(),o(function(){e.playPauseButton="play",l.triggerHandler("pause")}),!1}),l.on("ovLoadProgress",function(a,b){return a.stopImmediatePropagation(),o(function(){e.loadedStart=U.getCutPercent(b.loadedStart),e.loadedPercent=U.getCutDurationPercent(b.loadedPercent),l.triggerHandler("loadProgress",{loadedStart:e.loadedStart,loadedPercent:e.loadedPercent})}),!1}),l.on("ovPlayProgress",function(a,b){if(a.stopImmediatePropagation(),!e.initializing){e.loading=!1;var c=p(b.time),d=function(){e.time=U.getCutTime(b.time),e.seenPercent=U.getCutPercent(b.percent),e.presentation=null!==c&&e.timecodesByTime[c]?e.timecodesByTime[c].image.large:null;var a={time:e.time,percent:e.seenPercent};l.triggerHandler("playProgress",a);var d=new Date;d.setDate(d.getDate()+1),e.ovRememberPosition&&j.putObject("videoStopped_"+e.data.mediaId,a,{expires:d})};return e.duration&&U.getCutTime(b.time)>U.getCutDuration()?(e.player.setTime(U.getRealTime(0)),e.ovRememberPosition&&j.remove("videoStopped_"+e.data.mediaId),J=0,e.player.playPause()):o(d),!1}}),l.on("ovEnd",function(a){return a.stopImmediatePropagation(),o(function(){e.ovRememberPosition&&j.remove("videoStopped_"+e.data.mediaId),e.time=e.seenPercent=0,J=0,e.playPauseButton="play";var a=p(e.time);null!==a&&e.timecodes.length&&(e.presentation=e.timecodesByTime[a]?e.timecodesByTime[a].image.large:null),e.isCut&&e.player.setTime(U.getRealTime(0)),l.triggerHandler("end")}),!1}),l.on("ovError",function(a,b){o(function(){switch(e.loading=!1,e.initializing=!1,b){case k.MEDIA_ERR_NO_SOURCE:e.error=f("ovPlayerTranslate")("MEDIA_NO_SOURCE");break;case k.MEDIA_ERR_NETWORK:e.error=f("ovPlayerTranslate")("MEDIA_ERR_NETWORK");break;case k.MEDIA_ERR_DECODE:e.error=f("ovPlayerTranslate")("MEDIA_ERR_DECODE");break;case k.MEDIA_ERR_SRC_NOT_SUPPORTED:e.error=f("ovPlayerTranslate")("MEDIA_ERR_SRC_NOT_SUPPORTED");break;case k.MEDIA_ERR_PERMISSION:e.error=f("ovPlayerTranslate")("MEDIA_ERR_PERMISSION");break;default:e.error=f("ovPlayerTranslate")("MEDIA_ERR_DEFAULT")}l.triggerHandler("error",{code:b,message:e.error})})})}]}}var d=["media","both","both-presentation","presentation"];b.directive("ovPlayer",c),c.$inject=["$injector","$document","$sce","$filter","$timeout","ovPlayerService","ovPlayerI18nService","$cookies","ovPlayerErrors"]}(angular,angular.module("ov.player")),function(a,b){function c(b,c,d,e){function f(a){switch(a.type){case"progress":var b=this.player.buffered();if(b.length>=1){var c=this.player.currentTime()/this.player.duration()||0;this.jPlayerElement.triggerHandler("ovLoadProgress",{loadedStart:100*Math.max(0,Math.min(c,1)),loadedPercent:100*this.player.bufferedPercent()})}break;case"durationchange":var d=this.player.duration()||this.media.metadata&&this.media.metadata.duration;this.jPlayerElement.triggerHandler("ovDurationChange",1e3*d);break;case"loadedmetadata":this.loaded=!0,this.jPlayerElement.triggerHandler("ovReady");break;case"play":this.jPlayerElement.triggerHandler("ovPlay");break;case"pause":this.jPlayerElement.triggerHandler("ovPause");break;case"ended":this.jPlayerElement.triggerHandler("ovEnd");break;case"waiting":this.jPlayerElement.triggerHandler("ovWaiting");break;case"playing":this.jPlayerElement.triggerHandler("ovPlaying");break;case"timeupdate":var e=this.player.currentTime(),f=e/this.player.duration()*100;this.jPlayerElement.triggerHandler("ovPlayProgress",{time:1e3*e,percent:f});break;case"error":this.player.networkState()==this.player.NETWORK_NO_SOURCE&&(a.target.error={code:"NO_SOURCE",MEDIA_NO_SOURCE:"NO_SOURCE"}),this.jPlayerElement.triggerHandler("error",a.target.error&&a.target.error.code)}}function g(a){var b,c=this.getAvailableDefinitions(),d=a||c&&c[c.length-1]||null;b=d?[{src:d.link,type:"video/mp4"}]:this.media.sources[this.selectedSourceIndex].adaptive.map(function(a){var b={};return b.src=a.link,b.type=a.mimeType,b}),this.player.src(b),this.player.load()}function h(a,c,d){b.prototype.init.call(this,a,d),this.setMedia(c)}var i=["loadeddata","progress","playing","waiting","ended","durationchange","loadedmetadata","timeupdate","play","pause","error"];return h.prototype=new b,h.prototype.constructor=h,h.prototype.getMediaThumbnail=function(){return this.media.thumbnail},h.prototype.initialize=function(){var b=this;this.loaded=!1,this.player=videojs(this.playerId,{techOrder:["html5","flash"],autoplay:!1,preload:"auto"}),this.handlePlayerEventsFn=a.bind(this,f);for(var c=0;c<i.length;c++)this.player.on(i[c],this.handlePlayerEventsFn);this.player.ready(function(){this.error_||b.load()})},h.prototype.load=function(){g.call(this)},h.prototype.setDefinition=function(a){g.call(this,a)},h.prototype.isPaused=function(){return this.player.paused()},h.prototype.isPlaying=function(){return!this.isPaused()},h.prototype.playPause=function(){this.player.paused()||this.player.ended()?this.player.play():this.player.pause()},h.prototype.setVolume=function(a){this.player.volume(a/100)},h.prototype.setTime=function(a){a=parseInt(a)||.1,this.player.currentTime(a/1e3)},h.prototype.setMedia=function(a){b.prototype.setMedia.call(this,a);for(var c=0;c<this.media.sources.length;c++)this.media.sources[c].files&&this.media.sources[c].files.sort(function(a,b){return a.height<b.height?1:-1})},h.prototype.getPlayerType=function(){return"html"},h.prototype.getAvailableDefinitions=function(){var a=this.media.sources[this.selectedSourceIndex];return a.adaptive&&0!=a.adaptive.length?null:a.files},h.prototype.destroy=function(){this.handlePlayerEventsFn=a.bind(this,f);for(var b=a.element(this.player),c=0;c<i.length;c++)b.off(i[c],this.handlePlayerEventsFn);this.loaded=!1,this.player.dispose(),this.player=null},h}b.factory("OvPlayerHTML",c),c.$inject=["OvPlayer","$window","$document","$sce"]}(angular,angular.module("ov.player")),function(a,b){function c(b,c,d,e){function f(a,b){if(this.loaded){var c={method:a};return b&&(c.value=b),this.player.contentWindow.postMessage(JSON.stringify(c),this.postMessageTargetOrigin)}return null}function g(){this.postMessageTargetOrigin="https://player.vimeo.com/video/"+this.media.mediaId[this.selectedSourceIndex],this.player=d[0].getElementById(this.playerId),this.loaded=!0,this.playing=0,f.call(this,"addEventListener","loadProgress"),f.call(this,"addEventListener","playProgress"),f.call(this,"addEventListener","play"),f.call(this,"addEventListener","pause"),f.call(this,"addEventListener","finish")}function h(a,b){if(b=a.data?JSON.parse(a.data):b,b.player_id===this.playerId){switch(b.event){case"ready":g.call(this),f.call(this,"getDuration"),this.jPlayerElement.triggerHandler("ovReady");break;case"loadProgress":this.jPlayerElement.triggerHandler("ovLoadProgress",{loadedStart:0,loadedPercent:100*b.data.percent});break;case"playProgress":b.data.percent<=1&&this.jPlayerElement.triggerHandler("ovPlayProgress",{time:1e3*b.data.seconds,percent:100*b.data.percent});break;case"play":this.playing=1,this.jPlayerElement.triggerHandler("ovPlay");break;case"pause":this.playing=0,this.jPlayerElement.triggerHandler("ovPause");break;case"finish":this.playing=0,this.jPlayerElement.triggerHandler("ovEnd")}switch(b.method){case"getDuration":this.duration=b.value,this.jPlayerElement.triggerHandler("ovDurationChange",1e3*this.duration);break;default:return}}}function i(){this.loaded=!1,this.handlePlayerEventsFn=a.bind(this,h),a.element(c).on("message",this.handlePlayerEventsFn)}function j(a,c,d){b.prototype.init.call(this,a,d),this.setMedia(c)}return j.prototype=new b,j.prototype.constructor=j,j.prototype.getSourceUrl=function(){return e.trustAsResourceUrl("//player.vimeo.com/video/"+this.media.mediaId[this.selectedSourceIndex]+"?api=1&player_id="+this.playerId)},j.prototype.getMediaThumbnail=function(){return null},j.prototype.initialize=function(){i.call(this)},j.prototype.load=function(){},j.prototype.isPaused=function(){return!this.playing},j.prototype.isPlaying=function(){return this.playing},j.prototype.playPause=function(){f.call(this,this.playing?"pause":"play")},j.prototype.setVolume=function(a){f.call(this,"setVolume",a/100)},j.prototype.setTime=function(a){a=parseInt(a)||0,f.call(this,"seekTo",String(a/1e3)),this.playing||this.jPlayerElement.triggerHandler("ovPlayProgress",{time:a,percent:a/this.duration*100})},j.prototype.getPlayerType=function(){return"vimeo"},j.prototype.getAvailableDefinitions=function(){return null},j.prototype.setDefinition=function(a){},j.prototype.destroy=function(){a.element(c).off("message",this.handlePlayerEventsFn),this.loaded=!1,this.playing=0,this.player=null},j}b.factory("OvPlayerVimeo",c),c.$inject=["OvPlayer","$window","$document","$sce"]}(angular,angular.module("ov.player")),function(a,b){function c(b,c,d){function e(a,b){switch(b=a.data?JSON.parse(a.data):b,b.event){case"infoDelivery":void 0!==b.info.currentTime&&this.duration&&this.jPlayerElement.triggerHandler("ovPlayProgress",{time:1e3*b.info.currentTime,percent:b.info.currentTime/this.duration*100}),b.info.videoLoadedFraction&&this.jPlayerElement.triggerHandler("ovLoadProgress",{loadedStart:0,loadedPercent:100*b.info.videoLoadedFraction});break;case"onStateChange":if(b.info!=YT.PlayerState.PLAYING)this.playing=0,this.jPlayerElement.triggerHandler("ovPause"),b.info==YT.PlayerState.ENDED?this.jPlayerElement.triggerHandler("ovEnd"):b.info==-1&&this.jPlayerElement.triggerHandler("ovReady");else{this.playing=1,this.jPlayerElement.triggerHandler("ovPlay"),this.requestPause&&(this.requestPause=!1,this.player.pauseVideo());var c=this.player.getDuration();!this.duration&&c&&(this.duration=c,this.jPlayerElement.triggerHandler("ovDurationChange",1e3*this.duration))}}}function f(){if(this.ressourceLoaded&&this.apiLoaded){var b=this;this.loaded=!1,this.player=new YT.Player(this.playerId,{playerVars:{fs:0,rel:0,autoplay:0,html5:1,theme:"light",modesbranding:1,color:"white",iv_load_policy:3,showinfo:0,controls:0,hl:this.media.language},events:{onReady:function(){b.handlePlayerEventsFn=a.bind(b,e),a.element(c).on("message",b.handlePlayerEventsFn);for(var d=a.element(b.player),f=0;f<h.length;f++)d.on(h[f],b.handlePlayerEventsFn);b.loaded=!0,b.playing=0,b.load()},onError:function(a){switch(a.data){case 100:case 101:case 150:b.jPlayerElement.triggerHandler("ovError",d.MEDIA_ERR_PERMISSION);break;default:b.jPlayerElement.triggerHandler("ovError",d.MEDIA_ERR_UNKNOWN)}}},videoId:this.media.mediaId[this.selectedSourceIndex]})}}function g(a,d,e){var g=this,h="youtube-iframe-api";b.prototype.init.call(this,a,e),this.setMedia(d),this.requestPause=!1;var i=document.createElement("script");if(i.setAttribute("id",h),i.src="https://www.youtube.com/iframe_api",c.onYouTubeIframeAPIReady=function(){g.apiLoaded=!0,f.call(g)},document.getElementById(h))this.apiLoaded=!0,f.call(g);else{var j=document.getElementsByTagName("script")[0];j.parentNode.insertBefore(i,j)}}var h=["onStateChange","infoDelivery","infoDelivery","onPlaybackQualityChange","loadeddata","progress","playing","ended","timeupdate","error"];return g.prototype=new b,g.prototype.constructor=g,g.prototype.getMediaThumbnail=function(){return null},g.prototype.initialize=function(){this.ressourceLoaded=!0,f.call(this)},g.prototype.playPause=function(){this.player.getPlayerState()===YT.PlayerState.PLAYING?this.player.pauseVideo():(this.requestPause=!1,this.player.playVideo())},g.prototype.setVolume=function(a){this.player.setVolume(a)},g.prototype.setTime=function(a){var b=this.player.getPlayerState();a=parseInt(a)||0,this.playing||b!==YT.PlayerState.CUED||(this.requestPause=!0),this.player.seekTo(a/1e3,!0),this.playing||this.jPlayerElement.triggerHandler("ovPlayProgress",{time:a,percent:a/this.duration*100})},g.prototype.getPlayerType=function(){return"youtube"},g.prototype.isPaused=function(){return this.player.getPlayerState()===YT.PlayerState.PAUSED},g.prototype.isPlaying=function(){return this.player.getPlayerState()===YT.PlayerState.PLAYING},g.prototype.load=function(){this.player.cueVideoById(this.media.mediaId[this.selectedSourceIndex])},g.prototype.getAvailableDefinitions=function(){var a=[];return this.player&&(a=this.player.getAvailableQualityLevels()),a||[]},g.prototype.setMedia=function(a){b.prototype.setMedia.call(this,a),this.duration=null},g.prototype.setDefinition=function(a){this.player.setPlaybackQuality(a),this.jPlayerElement.triggerHandler("ovReady")},g.prototype.destroy=function(){a.element(c).off("message",this.handlePlayerEventsFn),this.player.destroy(),this.loaded=!1,this.playing=0,this.player=null,this.duration=null},g}b.factory("OvPlayerYoutube",c),c.$inject=["OvPlayer","$window","ovPlayerErrors"]}(angular,angular.module("ov.player")),function(a){function b(){this.media=null,this.cutStart=0,this.cutEnd=null,this.realMediaDuration=null,this.isCut=!1}b.prototype.getRealCutStart=function(){return this.realMediaDuration&&this.cutStart?this.realMediaDuration*this.cutStart:0},b.prototype.getRealCutEnd=function(){return this.realMediaDuration?this.cutEnd?this.realMediaDuration*this.cutEnd:this.realMediaDuration:0},b.prototype.getRealTime=function(a){return a+this.getRealCutStart()},b.prototype.getCutTime=function(a){return Math.max(a-this.getRealCutStart(),0)},b.prototype.setMedia=function(a){if(this.media=a,this.isCut=this.media.cut&&this.media.cut.length,this.isCut){for(var b=0;b<this.media.cut.length;b++)"begin"===this.media.cut[b].type?this.cutStart=Math.max(this.media.cut[b].value,0):"end"===this.media.cut[b].type&&(this.cutEnd=Math.min(this.media.cut[b].value,1));this.cutStart===this.cutEnd&&(this.cutStart=0,this.cutEnd=null)}else this.cutStart=0,this.cutEnd=null},b.prototype.getMediaTimecodes=function(){if(this.isCut&&this.realMediaDuration&&this.media.timecodes){for(var a=[],b=this.getRealCutStart(),c=this.getRealCutEnd(),d=0;d<this.media.timecodes.length;d++){var e=this.media.timecodes[d].timecode;e>=b&&e<=c&&a.push(this.media.timecodes[d])}return a}return this.media.timecodes},b.prototype.getMediaTimecodesByTime=function(){var a={},b=this.getMediaTimecodes();if(b)for(var c=0;c<b.length;c++){var d=b[c];a[d.timecode]={image:{small:d.image.small,large:d.image.large}}}return a},b.prototype.getMediaPointsOfInterest=function(a){if(this.isCut&&this.realMediaDuration&&this.media[a]){for(var b=[],c=this.getRealCutStart(),d=this.getRealCutEnd(),e=0;e<this.media[a].length;e++){var f=this.realMediaDuration*this.media[a][e].value;f>c&&f<d&&b.push(this.media[a][e])}return angular.copy(b)}return angular.copy(this.media[a])},b.prototype.processPointsOfInterestTime=function(a){for(var b=0;b<a.length;b++)a[b].value=a[b].value*this.realMediaDuration-Math.floor(this.cutStart*this.realMediaDuration)},b.prototype.getCutDuration=function(){if(this.realMediaDuration){var a=this.getRealCutEnd(),b=this.getRealCutStart();return a-b}return 0},b.prototype.getCutPercent=function(a){if(this.realMediaDuration){var b=this.realMediaDuration*(a/100);return Math.min(Math.max((b-this.getRealCutStart())/this.getCutDuration()*100,0),100)}return a},b.prototype.getCutDurationPercent=function(a){if(this.realMediaDuration){var b=this.realMediaDuration*(a/100);return Math.min(Math.max(b/this.getCutDuration()*100,0),100)}return a},b.prototype.setRealMediaDuration=function(a){this.realMediaDuration=a},a.value("ovPlayerService",b)}(angular.module("ov.player")),function(a){function b(){return{restrict:"E",templateUrl:ovPlayerDirectory+"templates/tabs.html",scope:{},transclude:!0,controller:["$scope","$filter",function(a,b){a.views=[],a.select=function(b){angular.forEach(a.views,function(a){a.selected=!1}),b.selected=!0},this.selectTabs=function(c){var d=b("filter")(a.views,{viewId:c},!0);0!=d.length&&a.select(d[0])},this.addView=function(b){a.views.length||a.select(b),a.views.push(b)},this.removeView=function(b){var c=a.views.indexOf(b);c!==-1&&a.views.splice(c,1)}}]}}a.directive("ovPlayerTabs",b)}(angular.module("ov.player")),function(a){function b(a){return{require:["^ovPlayer","^ovPlayerTabs"],restrict:"E",templateUrl:ovPlayerDirectory+"templates/tags.html",scope:!0,link:a}}a.factory("ovTagsLink",["$sce",function(a){return function(b,c,d,e){b.controller=e[0],b.goToTimecode=function(a){var c=e[0],d=e[1];a<=b.duration&&c.setTime(a),d.selectTabs("media")},b.setTagSrc=function(a){b.selectedTag=a,b.simpleMimeType=b.getFileMimeType(),b.selectedTagSrc=b.simpleMimeType?b.selectedTag.file.basePath:null},b.getFileMimeType=function(){return b.selectedTag&&b.selectedTag.file?"image"==b.selectedTag.file.mimetype.substr(0,"image".length)?"image":"video"==b.selectedTag.file.mimetype.substr(0,"video".length)?"video":"audio"==b.selectedTag.file.mimetype.substr(0,"audio".length)?"audio":b.selectedTag.file.mimetype:null;
},b.trustedHTML=function(b){return a.trustAsHtml(b)}}}]),a.directive("ovPlayerTags",b),b.$inject=["ovTagsLink"]}(angular.module("ov.player")),function(a){function b(){return function(a){if(a<0||isNaN(a))return"";a=parseInt(a);var b=parseInt(a/1e3%60),c=parseInt(a/6e4%60),d=parseInt(a/36e5%24);return d=d<10?"0"+d:d,c=c<10?"0"+c:c,b=b<10?"0"+b:b,("00"!==d?d+":":"")+c+":"+b}}a.filter("ovPlayerMillisecondsToTime",b)}(angular.module("ov.player")),function(a){function b(a){return{restrict:"E",require:"^ovPlayerTabs",transclude:!0,templateUrl:ovPlayerDirectory+"templates/view.html",scope:{title:"@",view:"@",viewId:"@"},link:a}}a.factory("ovViewLink",function(){return function(a,b,c,d){d.addView(a),a.$on("$destroy",function(){d.removeView(a)})}}),a.directive("ovPlayerView",b),b.$inject=["ovViewLink"]}(angular.module("ov.player"));